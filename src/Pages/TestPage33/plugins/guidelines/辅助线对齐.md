## 功能概述
辅助线功能帮助用户在画布上精确对齐对象。当用户拖动或缩放当前选中对象时，辅助线插件会自动检测当前选中对象与画布边界、画布中心以及画布上其他元素（矩形、图片等）的对齐关系，显示辅助线并自动吸附到对齐位置。

## 触发条件
辅助线仅在以下条件下生效：

1. 编辑器处于「选择模式」
2. 用户正在拖动当前选中对象移动位置，或正在缩放当前选中对象的尺寸

在绘制模式、拖拽画布模式、区域框选模式下，辅助线功能自动禁用。

## 参与对齐的参照物
辅助线插件会检测当前选中对象与以下参照物的对齐关系：

### 1. 画布（默认开启）
画布作为参照物时，提供以下对齐基准：

+ 画布左边缘、右边缘
+ 画布上边缘、下边缘
+ 画布水平中心线、垂直中心线

注：画布边界是相对于视口的绝对位置，缩放或平移画布后，画布边界的屏幕位置会随之变化。

### 2. 画布上的其他元素
除当前选中对象以外的所有可见元素（矩形、图片等），辅助线插件会逐一检测当前选中对象与每个元素的对齐关系。

## 多选对齐机制
当用户框选或 Ctrl+点击选中多个对象后进行拖动时，辅助线的行为如下：

### 整体边界计算
多选时，辅助线插件会将所有选中对象视为一个整体，计算其外接矩形边界作为对齐基准：

+ 整体左边缘 = 所有选中对象中最左侧的边缘
+ 整体右边缘 = 所有选中对象中最右侧的边缘
+ 整体上边缘 = 所有选中对象中最上方的边缘
+ 整体下边缘 = 所有选中对象中最下方的边缘
+ 整体中心 = 外接矩形的几何中心

### 参照物排除规则
多选拖动时，所有被选中的对象都会从参照物列表中排除，即：

+ 选中对象之间不会互相产生辅助线
+ 只会与未选中的其他元素、画布边界进行对齐检测

这样可以避免拖动时出现"粘"在选中元素内部的辅助线。

### 吸附行为
多选整体吸附时，所有选中对象会保持相对位置不变，整体移动到对齐位置。


## 移动对齐

### 辅助线类型
#### 垂直辅助线（竖线）
当当前选中对象的左边、右边或水平中心与参照物对齐时显示：

| 对齐方式 | 说明 |
| --- | --- |
| 左对左 | 当前选中对象的左边缘 与 参照物的左边缘对齐 |
| 左对右 | 当前选中对象的左边缘 与 参照物的右边缘对齐 |
| 右对左 | 当前选中对象的右边缘 与 参照物的左边缘对齐 |
| 右对右 | 当前选中对象的右边缘 与 参照物的右边缘对齐 |
| 中对中 | 当前选中对象的水平中心 与 参照物的水平中心对齐 |
| 左对中 | 当前选中对象的左边缘 与 参照物的水平中心对齐 |
| 右对中 | 当前选中对象的右边缘 与 参照物的水平中心对齐 |

#### 水平辅助线（横线）
当当前选中对象的上边、下边或垂直中心与参照物对齐时显示：

| 对齐方式 | 说明 |
| --- | --- |
| 上对上 | 当前选中对象的上边缘 与 参照物的上边缘对齐 |
| 上对下 | 当前选中对象的上边缘 与 参照物的下边缘对齐 |
| 下对上 | 当前选中对象的下边缘 与 参照物的上边缘对齐 |
| 下对下 | 当前选中对象的下边缘 与 参照物的下边缘对齐 |
| 中对中 | 当前选中对象的垂直中心 与 参照物的垂直中心对齐 |
| 上对中 | 当前选中对象的上边缘 与 参照物的垂直中心对齐 |
| 下对中 | 当前选中对象的下边缘 与 参照物的垂直中心对齐 |

## 缩放对齐
当用户拖动当前选中对象的控制点调整尺寸时，辅助线插件会检测当前选中对象正在拖动的边缘与参照物的对齐关系。

### 触发条件
当用户拖动当前选中对象的 8 个控制点（四角 + 四边中点）进行缩放操作时，辅助线插件自动触发缩放对齐检测。

### 检测规则
辅助线插件只检测当前选中对象正在拖动的边缘：

| 控制点 | 检测的边缘 |
| --- | --- |
| tl（左上角） | 当前选中对象的左边缘、上边缘 |
| tr（右上角） | 当前选中对象的右边缘、上边缘 |
| bl（左下角） | 当前选中对象的左边缘、下边缘 |
| br（右下角） | 当前选中对象的右边缘、下边缘 |
| ml（左中） | 当前选中对象的左边缘 |
| mr（右中） | 当前选中对象的右边缘 |
| mt（上中） | 当前选中对象的上边缘 |
| mb（下中） | 当前选中对象的下边缘 |

### 吸附行为
缩放吸附时，当前选中对象的对边保持固定，辅助线插件仅调整当前选中对象正在拖动的边缘位置：

+ 用户拖动左边控制点：当前选中对象的左边缘吸附到参照物对齐位置，右边缘不变，宽度相应调整
+ 用户拖动右边控制点：当前选中对象的右边缘吸附到参照物对齐位置，左边缘不变，宽度相应调整
+ 用户拖动上边控制点：当前选中对象的上边缘吸附到参照物对齐位置，下边缘不变，高度相应调整
+ 用户拖动下边控制点：当前选中对象的下边缘吸附到参照物对齐位置，上边缘不变，高度相应调整
+ 用户拖动角点控制点：辅助线插件同时检测当前选中对象在水平和垂直两个方向的对齐

## 坐标说明
所有对齐检测均基于场景坐标（绝对坐标）进行计算，不受画布缩放和平移的影响。即：

+ 两个对象在场景中的实际位置对齐时才会触发辅助线
+ 缩放画布不会改变对象之间的对齐关系
+ 吸附阈值（默认 5 像素）会根据缩放比例自动调整，确保在任意缩放级别下体验一致

## 自动吸附
当当前选中对象接近对齐位置时（默认阈值 5 像素），辅助线插件会自动将当前选中对象吸附到精确对齐的位置。

## 对齐优先级
当当前选中对象同时接近多个参照物的对齐位置时，辅助线插件会选择距离最近的对齐点进行吸附，同一方向只显示一条辅助线。
